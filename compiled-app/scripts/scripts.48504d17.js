"use strict";angular.module("elevatorAppApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","underscore"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("elevatorAppApp").controller("MainCtrl",["$scope","_",function(a,b){var c={elevatorMaxLoad:20,isAllowedLoad:function(a){return a>0&&a<=this.elevatorMaxLoad}},d=function(a){return{number:a,passengers:{boarding:0,destinationFloor:""},requestElevator:function(){return f.getTargetElevator(this)},empty:function(){return this.passengers.boarding=0,this.passengers.destinationFloor=this.number,this}}},e=function(a){return{name:a,people:0,floor:1,destinationFloor:1,sourceFloor:1,travelDirection:"stationary",addPassengers:function(a){return c.isAllowedLoad(this.people+a)&&(this.people+=a),this},setTravelDirection:function(a){return this.travelDirection=a?"stationary":this.destinationFloor>this.sourceFloor?"up":"down",this},goToFloor:function(a,b){return this.destinationFloor=a,this.floor=a,this.sourceFloor=b,this.setTravelDirection(),this},empty:function(){return this.people=0,this.setTravelDirection(!0),this}}},f={availableElevators:function(d){return b.filter(a.elevators,function(a){return c.isAllowedLoad(a.people+d.passengers.boarding)})},onFloorElevators:function(a){return b.filter(this.availableElevators(a),function(b){return b.floor===a.number})},nearestAvailElevator:function(a){return b.min(this.availableElevators(a),function(b){return Math.abs(a.number-b.floor)})},getTargetElevator:function(a){var b=this.onFloorElevators(a);return b.length>0?b[0]:this.nearestAvailElevator(a)},isDispatchableFloor:function(a){return c.isAllowedLoad(a.passengers.boarding)}};a.dispatch=function(){a.floors.forEach(function(a){f.isDispatchableFloor(a)&&(a.requestElevator().addPassengers(a.passengers.boarding).goToFloor(a.passengers.destinationFloor,a.number),a.empty())})},a.elevators=[new e("A"),new e("B"),new e("C"),new e("D")],a.floors=[];for(var g=10;g>=1;g--)a.floors.push(new d(g))}]),angular.module("elevatorAppApp").filter("otherFloors",["_",function(a){return function(b,c){return a.filter(b,function(a){return a.number!==c})}}]);